import type { ClientPerspective } from '@sanity/client'
import LRUCache from 'mnemonist/lru-cache'
import type { SanityDocument } from '@sanity/client'

/**
 * @alpha
 */
export declare interface ClientConfigLike {
  projectId: ClientProjectId
  dataset: ClientDataset
  perspective: DocumentCachePerspective
}

/**
 * TODO add `ClientDataset` to `@sanity/client`
 * @alpha
 */
export declare type ClientDataset = string

export { ClientPerspective }

/**
 * TODO add `ClientProjectId` to `@sanity/client`
 * @alpha
 */
export declare type ClientProjectId = string

/**
 * @alpha
 */
export declare type DocumentCacheKey =
  `${ClientProjectId}-${ClientDataset}-${DocumentCachePerspective}-${DocumentId}`

/**
 * The only perspectives supported by the cache is `published` and `previewDrafts`.
 * @alpha
 */
export declare type DocumentCachePerspective = Extract<
  ClientPerspective,
  'published' | 'previewDrafts'
>

/**
 * @alpha
 */
export declare type DocumentId = string

export { SanityDocument }

/**
 * @alpha
 */
export declare interface SanityDocumentLike {
  _id: DocumentId
}

/**
 * @alpha
 */
export declare const unstable__documentsCache: LRUCache<
  | `${string}-${string}-previewDrafts-${string}`
  | `${string}-${string}-published-${string}`,
  SanityDocument
>

/**
 * @alpha
 */
export declare function unstable__getDocumentCacheKey(
  config: ClientConfigLike,
  document: SanityDocumentLike,
): DocumentCacheKey

export {}
