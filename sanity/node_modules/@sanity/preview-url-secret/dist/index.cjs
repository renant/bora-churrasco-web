"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./_chunks/constants-Q2W1tUXO.cjs");exports.urlSearchParamPreviewPathname=e.b,exports.urlSearchParamPreviewSecret=e.u,exports.validatePreviewUrl=async function(r,t){const i=function(r){if(!r)throw new TypeError("`client` is required");if(!r.config().token)throw new TypeError("`client` must have a `token` specified");return r.withConfig({apiVersion:e.a,useCdn:!1,perspective:"published",resultSourceMap:!1,stega:!1})}(r);let s;try{s=function(r){const t=new URL(r,"http://localhost"),i=t.searchParams.get(e.u);if(!i)throw new Error("Missing secret");let s;const n=t.searchParams.get(e.b);if(n){const{pathname:e,search:r}=new URL(n,"http://localhost");s=`${e}${r}`}return{secret:i,redirectTo:s}}(t)}catch(r){return e.i&&console.error("Failed to parse preview URL",r,{previewUrl:t,client:i}),{isValid:!1}}const n=await async function(r,t){if("undefined"!=typeof EdgeRuntime&&await new Promise((e=>setTimeout(e,300))),!t||!t.trim())return!1;const i=await r.fetch(e.f,{secret:t},{tag:e.t,cache:"no-store"});return!!(i?._id&&i?._updatedAt&&i?.secret)&&t===i.secret}(i,s.secret);return{isValid:n,redirectTo:n?s.redirectTo:void 0}};//# sourceMappingURL=index.cjs.map
